<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
    <th:block th:replace="~{layout :: layout('Settings', 'settings', ~{::content})}">
      <th:block th:fragment="content">
        <div th:if="${saved}" class="rounded-xl border border-emerald-500/30 bg-emerald-500/10 p-4 text-sm text-emerald-600 dark:border-emerald-400/30 dark:text-emerald-300">
          <span th:switch="${saved}">
            <span th:case="'notifications'">Notificaciones actualizadas correctamente.</span>
            <span th:case="'limits'">Límites y preferencias guardados.</span>
            <span th:case="*">Preferencias guardadas.</span>
          </span>
        </div>
        <section class="grid gap-6 lg:grid-cols-3">
        <article class="card lg:col-span-2">
          <div class="card-header">
            <h2 class="card-title">Credenciales API</h2>
            <p class="card-subtitle">Clave almacenada con cifrado AES-256</p>
          </div>
          <dl class="space-y-3">
            <div class="flex items-center justify-between rounded-xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900">
              <div>
                <dt class="text-sm font-medium text-slate-500">API Key</dt>
                <dd class="text-lg font-semibold tracking-widest" th:text="${settings.apiKey}">****ABCD1234</dd>
              </div>
              <button class="btn-secondary" type="button">Revelar</button>
            </div>
            <div class="flex items-center justify-between rounded-xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900">
              <div>
                <dt class="text-sm font-medium text-slate-500">Webhook secret</dt>
                <dd class="text-lg font-semibold tracking-widest" th:text="${settings.webhookSecret}">****DEMO</dd>
              </div>
              <button class="btn-secondary" type="button">Rotar</button>
            </div>
          </dl>
        </article>
        <article class="card">
          <div class="card-header">
            <h2 class="card-title">Notificaciones</h2>
          </div>
          <form class="space-y-4" method="post" th:action="@{/tenant/settings/notifications}" th:object="${settings.notifications}">
            <label class="flex items-center gap-3">
              <input class="toggle" type="checkbox" th:field="*{email}" />
              <span>Email</span>
            </label>
            <label class="flex items-center gap-3">
              <input class="toggle" type="checkbox" th:field="*{telegram}" />
              <span>Telegram</span>
            </label>
            <button class="btn-primary" type="submit">Guardar</button>
          </form>
        </article>
      </section>
      <section class="card">
        <div class="card-header">
          <h3 class="card-title">Límites por defecto</h3>
        </div>
        <form class="grid gap-4 md:grid-cols-2" method="post" th:action="@{/tenant/settings/limits}" th:object="${settings.riskLimits}">
          <div>
            <label class="form-label" for="dailyLoss">Pérdida diaria máx (%)</label>
            <input class="form-input" id="dailyLoss" th:field="*{maxDailyLoss}" type="number" step="0.1" />
          </div>
          <div>
            <label class="form-label" for="singleTrade">Pérdida por trade máx (%)</label>
            <input class="form-input" id="singleTrade" th:field="*{maxTradeLoss}" type="number" step="0.1" />
          </div>
          <div>
            <label class="form-label" for="exposure">Exposición (%)</label>
            <input class="form-input" id="exposure" th:field="*{maxExposure}" type="number" step="0.1" />
          </div>
          <div>
            <label class="form-label" for="timezone">Timezone</label>
            <select class="form-input" id="timezone" th:field="*{timezone}">
              <option th:each="zone : ${settings.timezones}" th:value="${zone}" th:text="${zone}"></option>
            </select>
          </div>
          <div class="md:col-span-2 flex items-center gap-2">
            <input class="toggle" id="darkModePref" type="checkbox" th:field="*{darkMode}" />
            <label for="darkModePref">Forzar dark mode por defecto</label>
          </div>
          <div class="md:col-span-2">
            <button class="btn-primary" type="submit">Guardar cambios</button>
          </div>
        </form>
      </section>
    </th:block>
  </th:block>
</html>
