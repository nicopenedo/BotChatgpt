{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {"type": "datasource", "uid": "grafana"},
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "panels": [
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "currency"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 0},
      "id": 1,
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      },
      "targets": [
        {"expr": "risk_daily_pnl{app=\"bot-trading\"}", "legendFormat": "PnL"}
      ],
      "title": "Daily PnL",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "percent"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 0},
      "id": 2,
      "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "multi"}},
      "targets": [
        {"expr": "risk_dd_max{app=\"bot-trading\"}", "legendFormat": "Max DD"}
      ],
      "title": "Max Drawdown",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "percent"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 8},
      "id": 3,
      "options": {
        "legend": {"displayMode": "list", "placement": "bottom"},
        "tooltip": {"mode": "multi"}
      },
      "targets": [
        {"expr": "risk_daily_loss_pct{app=\"bot-trading\"}", "legendFormat": "loss pct"},
        {"expr": "risk_daily_loss_limit_pct{app=\"bot-trading\"}", "legendFormat": "limit"}
      ],
      "title": "Daily Loss vs Limit",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "short"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 8},
      "id": 4,
      "options": {"legend": {"displayMode": "table", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "targets": [
        {"expr": "increase(risk_stopouts_total{app=\"bot-trading\"}[24h])", "legendFormat": "stopouts"}
      ],
      "title": "Stopouts (24h)",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "percent"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 16},
      "id": 5,
      "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "multi"}},
      "targets": [
        {"expr": "risk_api_error_rate{app=\"bot-trading\"}", "legendFormat": "API error %"}
      ],
      "title": "API Error Rate",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "none"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 16},
      "id": 6,
      "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "multi"}},
      "targets": [
        {"expr": "risk_ws_reconnects{app=\"bot-trading\"}", "legendFormat": "reconnects"}
      ],
      "title": "WS Reconnects",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "currency"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 0, "y": 24},
      "id": 7,
      "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "multi"}},
      "targets": [
        {"expr": "risk_equity{app=\"bot-trading\"}", "legendFormat": "equity"}
      ],
      "title": "Equity",
      "type": "timeseries"
    },
    {
      "datasource": {"type": "prometheus", "uid": "${datasource:Prometheus}"},
      "fieldConfig": {"defaults": {"unit": "short"}, "overrides": []},
      "gridPos": {"h": 8, "w": 12, "x": 12, "y": 24},
      "id": 8,
      "options": {"legend": {"displayMode": "list", "placement": "bottom"}, "tooltip": {"mode": "single"}},
      "targets": [
        {"expr": "risk_market_data_stale{app=\"bot-trading\"}", "legendFormat": "stale"}
      ],
      "title": "Market Data Stale Flag",
      "type": "timeseries"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "style": "dark",
  "tags": ["bot-trading", "risk"],
  "templating": {"list": []},
  "time": {"from": "now-24h", "to": "now"},
  "timepicker": {},
  "timezone": "",
  "title": "Risk & Ops",
  "uid": null,
  "version": 1
}
